Надстройки для Outlook 2010-2013, позволяющие пользователю без запуска 1С оперативно выполнять согласование документов при поступлении оповещения на электронную почту.
Поддерживается интеграция с 1С:Документооборот ПРОФ и КОРП (работа с процессом "Согласование" с поддержкой просмотра файлов по внутренним и исходящим документам) и 1С:Консолидация ПРОФ (согласование "Заявок на расходование средств" и "Экземпляров отчетов" с возможностью просмотра печатных форм).
Позволяет облегчить работу некоторым пользователям по согласованию назначенных им документов в 1С.
Пользователь получает возможность оперативно просмотреть ключевую информацию по документу и сразу же согласовать или отклонить его.

Надстройки реализованы отдельно для 1С:Консолидация и 1С:Документооборот, поэтому могут использоваться как вместе, так и по отдельности.

Общий функционал:
1) Согласование или отклонение документа с комментариями:
  для 1С:Документооборот - процесс "Согласование"
  для 1С:Консолидация - "Заявка на расходование средств" и "Экземпляр отчета"
2) Просмотр истории согласования (в том числе, по уже обработанным документам).
3) Автоматическое формирование оповещения в Outlook о приближении крайней даты согласования документа.

Дополнительно для 1С:Документооборот:
1) Просмотр и корректировка приложенных к "Внутреннему документу" и "Исходящему документу" файлов.
2) Создание процесса "Поручение" на основании любого письма с возможностью передать в 1С вложенные в письмо файлы.

Дополнительно для 1С:Консолидация ПРОФ:
1) Просмотр печатных форм "Заявки на расходование средств" и "Экземляра отчета"

Для работы надстроек требуется внесение изменений в в конфигурации 1С и публикация web-сервисов (интеграция с 1С выполняется через веб-сервисы, что обеспечивает очень высокую скорость работы). Установить веб-сервер и опубликовать web-сервисы достаточно просто и не требует дополнительных затрат на лицензии.

Для работы надстроек требуется установленный NET Framework 4.0. Загрузить его можно бесплатно здесь.

Установка надстройки выполняется без административных прав пользователем самостоятельно.
Следует учесть, что надстройки устанавливаются из того каталога, из которого они были запущены, поэтому необходимо сразу копировать каталоги с надстройками на постоянное место (например, в "Мои документы")

После установки надстроек требуется указать местоположение 1С - адрес веб-сервиса, а также параметры доступа к нему - доменная авторизация, либо по обычному логину и паролю. Это нужно сделать отдельно для каждой из надстроек.

Обновление от 01.09.2012
1) для надстройки разрешена работа по http-протоколу
2) приложен новый cfu-файл с изменениями для релиза 1С:Документооборот КОРП 1.2.5.3 (updateDoc8_1.2.5.3.cfu)

Обновление от 10.03.2013
1) создана надстройка для 1С:Консолидация. cfu-файл собран для релиза 1С:Консолидация ПРОФ 2.1.2.1
2) в надстройку для 1С:Документооборот добавлен функционал формирования поручений на основании письма
3) приложен новый cfu-файл с изменениями для релиза 1С:Документооборот КОРП 1.2.8.1 и ПРОФ 1.2.8.1
4) все файлы собраны в один архив и приложены к статье
5) пароль пользователя для доступа к 1С при вводе скрывается
6) исправлено несколько ошибок, влиящих на стабильность работы надстроек

 Обновление от 08.09.2013
Выложил исходники для Visual Studio 2012

 

Настройки на сервере:
1) внести в конфигурацию необходимые доработки из cfu-файла обновления
2) опубликовать на веб-сервере веб-сервис "ALP_OutlookServices"
3) Если для пользователей будет использоваться обычная авторизация, а не доменная, то для пользователей, которые будут работать через надстройку, необходимо изменить имя пользователя в конфигураторе на латиницу. С кириллитическим именем авторизоваться на веб-сервисе пользователи не смогут!

 

 

Настройка на клиентской рабочей станции:
1) Распаковать дистрибутив с надстройкой, например, в "Мои документы" на компьютере пользователя.
2) Запустить файл setup.exe и подтвердить установку надстройки:

 



3) запустить Outlook, открыть любое входящее письмо, перейти на соответствующую закладку (для 1С:Консолидации или 1С:Документооборота) и нажать кнопку "Настройка параметров соединения"



4) заполнить адрес web-сервиса, способ аутентификации и логин/пароль (пароль хранится в реестре Windows в открытом виде!)



5) нажать "ОК", при этом система проверит подключение к web-сервису. При возникновении ошибки выдаст предупреждение, в случае успеха - тихо закроется.

 

Работа с надстройкой:
1) Во входящих письмах от 1С автоматически устанавливается красный флажок и оповещение о приближении крайнего срока выполнения:



2) При просмотре самого письма в его нижней части отображаются кнопки для выполнения операций: согласование, отклонение, просмотр истории согласования, а также управление файлами.



3) При нажатии кнопок "Согласовано" или "Отклонено" отображается окно для ввода комментария. После нажатия в нем "ОК" выполняется соответствующая операция и отображается ее результат. После успешного выполнения операции эти 2 кнопки в основной форме письма блокируются от дальнейших нажатий:







 

4) Кнопка "История согласования" (только для 1С:Документооборот) позволяет посмотреть аналогичный стандартный отчет 1С.



5) Кнопка "Файлы" (только для 1С:Документооборот) открывает отдельное окно, позволяющее (первое открытие может занять несколько секунд, т.к. файлы загружаются из Документооборота):

5.1) Открыть документы на просмотр

5.2) Захватить документы на редактирование (в Документообороте при этом файл отмечается "занятым" текущим пользователем)

5.3) Поместить скорректированные документы обратно в базу

5.4) Отменить захват документов

 

6) Для создания поручения в 1С:Документооборот на основании письма необходимо:
6.1) Открыть требуемое входящее письмо, перейти на закладку "1С:Документооборот 8" и нажать кнопку "Создать поручение на основе письма"


6.2) Указать пользователя - Поручение будет назначено тому пользователю, полное наименование которого будет указано в поле "Кому". Для облегчения выбора пользователя возможно набрать первые буквы фамилии, затем нажать "Загрузить". Если система обнаружит только 1 такого пользователя, то он будет подставлен сразу. Если несколько - необходимо будет уточнить конкретного пользователя из выпадающего списка.
Если же поле "Кому" оставить пустым и нажать кнопку "Загрузить", то выпадающий список будет заполнен всеми пользователями "1С:Документооборот". С одной стороны, это может быть удобно для выбора, но, с другой стороны, может сказаться на быстродействии при большом числе пользователей.


6.3) При необходимости скорректировать Тему, Описание, Срок и Важность. Выбрать передаваемые вложения и нажать "Создать поручение".


6.4) Если поручение было создано успешно, то в письмо будет добавлен соответствующий комментарий.


В "1С:Документооборот" будет создан соответствующий документ с прикрепленными файлами:




 

7) Во входящих письмах от "1С:Консолидация" есть возможность просмотра:
печатной формы "Заявки на расходование средств":


печатной формы "Экземпляра отчета" в том виде, как он доступен пользователю в 1С:



печатной формы отчета "История согласования":



 

Удаление надстроек с пользовательской рабочей станции:
Производится под обычными пользовательскими правами из панели управления в обычном порядке.

